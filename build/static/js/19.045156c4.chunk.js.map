{"version":3,"sources":["pages/User/Password.module.less","pages/User/Password.js"],"names":["module","exports","password-form-list","Password","props","_this","Object","_Users_michael_Desktop_sites_classroom_react_react_webpack_start_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_10__","this","_Users_michael_Desktop_sites_classroom_react_react_webpack_start_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_12__","_Users_michael_Desktop_sites_classroom_react_react_webpack_start_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_13__","call","onClickSubmit","e","preventDefault","_this$state","state","password","passwordConfirm","test","payload","modifyPassword","then","result","id","antd_mobile_lib_toast__WEBPACK_IMPORTED_MODULE_9___default","a","success","dispatch","fetchAccountInvalid","fail","message","onChangePass","value","replace","length","setState","haseErrorPass","onChangePassConfirm","haseErrorPassConfirm","react__WEBPACK_IMPORTED_MODULE_15___default","createElement","className","styles","antd_mobile_lib_list__WEBPACK_IMPORTED_MODULE_5___default","antd_mobile_lib_input_item__WEBPACK_IMPORTED_MODULE_7___default","clear","type","placeholder","minLength","maxLength","onChange","antd_mobile_lib_white_space__WEBPACK_IMPORTED_MODULE_3___default","antd_mobile_lib_button__WEBPACK_IMPORTED_MODULE_1___default","disabled","onClick","bind","PureComponent","createForm","withRouter","connect","currentUser","user"],"mappings":"8EACAA,EAAAC,QAAA,CAAkBC,qBAAA,8TCSZC,cAKJ,SAAAA,EAAYC,GAAO,IAAAC,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAL,IACjBE,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAAH,GAAAQ,KAAAH,KAAMJ,KAYRQ,cAAgB,SAAAC,GACdA,EAAEC,iBADiB,IAAAC,EAEiBV,EAAKW,MAAnCC,EAFaF,EAEbE,SACN,GAAIA,IAHeF,EAEHG,gBAChB,CAMA,GAAwB,qBAAbD,GAAyC,KAAbA,EAGhC,GAJa,sCAIIE,KAAKF,GAAtB,CAKP,IAAMG,EAAU,CAAEH,YAClBI,YAAeD,GAASE,KAAK,SAAAC,GAC3B,GAAsB,qBAAXA,GAA+C,qBAAdA,EAAOC,GAAoB,CACrEC,EAAAC,EAAMC,QAAQ,6CAAW,EAAG,MAAM,GAElCtB,EAAKD,MAAMwB,SAASC,YADH,gBAGjBJ,EAAAC,EAAMI,KAAuB,qBAAXP,EAAyBA,EAAOQ,QAAU,2GAX9DN,EAAAC,EAAMI,KAAK,6CAAW,EAAG,MAAM,QAH/BL,EAAAC,EAAMI,KAAK,uCAAU,EAAG,MAAM,QAN9BL,EAAAC,EAAMI,KAAK,yDAAa,EAAG,MAAM,IAjBlBzB,EA0CnB2B,aAAe,SAAAC,GACTA,EAAMC,QAAQ,MAAO,IAAIC,OAAS,EACpC9B,EAAK+B,SAAS,CACZC,eAAe,IAGjBhC,EAAK+B,SAAS,CACZC,eAAe,IAGnBhC,EAAK+B,SAAS,CACZnB,SAAUgB,KArDK5B,EAyDnBiC,oBAAsB,SAAAL,GAChBA,EAAMC,QAAQ,MAAO,IAAIC,OAAS,EACpC9B,EAAK+B,SAAS,CACZG,sBAAsB,IAGxBlC,EAAK+B,SAAS,CACZG,sBAAsB,IAG1BlC,EAAK+B,SAAS,CACZlB,gBAAiBe,KAlEnB5B,EAAKW,MAAQ,CACXC,SAAU,GACVC,gBAAiB,GACjBmB,eAAe,EACfE,sBAAsB,GANPlC,qHAyEjB,OACEmC,EAAAd,EAAAe,cAAA,OAAKC,UAAWC,IAAO,uBACrBH,EAAAd,EAAAe,cAAAG,EAAAlB,EAAA,KACEc,EAAAd,EAAAe,cAAAI,EAAAnB,EAAA,CACEO,MAAOzB,KAAKQ,MAAMC,SAClB6B,OAAK,EACLC,KAAK,WACLC,YAAY,iDACZC,UAAW,EACXC,UAAW,GACXC,SAAU3C,KAAKwB,gBAGnBQ,EAAAd,EAAAe,cAAAI,EAAAnB,EAAA,CACEO,MAAOzB,KAAKQ,MAAME,gBAClB4B,OAAK,EACLC,KAAK,WACLC,YAAY,6DACZC,UAAW,EACXC,UAAW,GACXC,SAAU3C,KAAK8B,sBAEjBE,EAAAd,EAAAe,cAAAW,EAAA1B,EAAA,MArBF,IAqBiBc,EAAAd,EAAAe,cAAAW,EAAA1B,EAAA,MArBjB,IAqBgCc,EAAAd,EAAAe,cAAAW,EAAA1B,EAAA,MAC9Bc,EAAAd,EAAAe,cAAAY,EAAA3B,EAAA,CACEqB,KAAK,UACLO,WACI9C,KAAKQ,MAAMqB,eAAiB7B,KAAKQ,MAAMuB,sBAE3CgB,QAAS/C,KAAKI,cAAc4C,KAAKhD,OALnC,gBASAgC,EAAAd,EAAAe,cAAAW,EAAA1B,EAAA,MA/BF,IA+BiBc,EAAAd,EAAAe,cAAAW,EAAA1B,EAAA,MA/BjB,IA+BgCc,EAAAd,EAAAe,cAAAW,EAAA1B,EAAA,cA9Gf+B,iBA6HRC,wBAAaC,YAAWC,YATf,SAAA5C,GAKtB,MAAO,CACL6C,YAHE7C,EADF8C,KAAQD,cAO2BD,CAAyBzD","file":"static/js/19.045156c4.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"password-form-list\":\"_1I4tlGLWpCoy5_tmvcpzKp\"};","import React, { PureComponent } from 'react'\nimport { connect } from 'react-redux'\nimport { withRouter } from 'react-router-dom'\nimport PropTypes from 'prop-types'\nimport { createForm } from 'rc-form'\nimport { List, InputItem, Toast, Button, WhiteSpace } from 'antd-mobile'\nimport styles from './Password.module.less'\nimport { modifyPassword } from '@/api/user'\nimport { fetchAccountInvalid } from '@/actions/login'\n\nclass Password extends PureComponent {\n  static propTypes = {\n    currentUser: PropTypes.object.isRequired,\n    dispatch: PropTypes.func.isRequired,\n  }\n  constructor(props) {\n    super(props)\n    this.state = {\n      password: '', // 密码\n      passwordConfirm: '', // 确认密码\n      haseErrorPass: false, // 密码是否输满8位\n      haseErrorPassConfirm: false, // 确认密码是否输满8位\n    }\n  }\n\n  componentDidMount() {}\n\n  // 提交修改\n  onClickSubmit = e => {\n    e.preventDefault()\n    let { password, passwordConfirm } = this.state\n    if (password !== passwordConfirm) {\n      Toast.fail('二次密码输入不一样', 3, null, false)\n      return\n    }\n    // 验证密码格式\n    const regPassword = /([a-zA-Z0-9!@#$%^&*()_?<>{}]){8,16}/\n    if (typeof password === 'undefined' || password === '') {\n      Toast.fail('密码不能为空', 3, null, false)\n      return\n    } else if (!regPassword.test(password)) {\n      Toast.fail('密码格式不正确', 3, null, false)\n      return\n    }\n    // 提交修改\n    const payload = { password }\n    modifyPassword(payload).then(result => {\n      if (typeof result !== 'undefined' && typeof result.id !== 'undefined') {\n        Toast.success('恭喜您修改成功', 3, null, false)\n        const pathname = '/login'\n        this.props.dispatch(fetchAccountInvalid(pathname))\n      } else {\n        Toast.fail(typeof result !== 'undefined' ? result.message : '用户得到授权，但是访问是被禁止的')\n      }\n    })\n  }\n\n  onChangePass = value => {\n    if (value.replace(/\\s/g, '').length < 8) {\n      this.setState({\n        haseErrorPass: false,\n      })\n    } else {\n      this.setState({\n        haseErrorPass: true,\n      })\n    }\n    this.setState({\n      password: value,\n    })\n  }\n\n  onChangePassConfirm = value => {\n    if (value.replace(/\\s/g, '').length < 8) {\n      this.setState({\n        haseErrorPassConfirm: false,\n      })\n    } else {\n      this.setState({\n        haseErrorPassConfirm: true,\n      })\n    }\n    this.setState({\n      passwordConfirm: value,\n    })\n  }\n\n  render() {\n    return (\n      <div className={styles['password-form-list']}>\n        <List>\n          <InputItem\n            value={this.state.password}\n            clear\n            type='password'\n            placeholder='请输入8-16位新密码'\n            minLength={8}\n            maxLength={16}\n            onChange={this.onChangePass}\n          />\n        </List>\n        <InputItem\n          value={this.state.passwordConfirm}\n          clear\n          type='password'\n          placeholder='请再次输入8-16位新密码'\n          minLength={8}\n          maxLength={16}\n          onChange={this.onChangePassConfirm}\n        />\n        <WhiteSpace /> <WhiteSpace /> <WhiteSpace />\n        <Button\n          type='primary'\n          disabled={\n            !(this.state.haseErrorPass && this.state.haseErrorPassConfirm)\n          }\n          onClick={this.onClickSubmit.bind(this)}\n        >\n          修改\n        </Button>\n        <WhiteSpace /> <WhiteSpace /> <WhiteSpace />\n      </div>\n    )\n  }\n}\n\nconst mapStateToProps = state => {\n  const {\n    user: { currentUser },\n  } = state\n\n  return {\n    currentUser,\n  }\n}\nexport default createForm()(withRouter(connect(mapStateToProps)(Password)))\n"],"sourceRoot":""}