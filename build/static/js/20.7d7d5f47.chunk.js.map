{"version":3,"sources":["pages/User/Styles.module.less","api/register.js","pages/User/Register.js"],"names":["module","exports","user-form-list","title","link","show-pass-style","hide","tips","_callee","params","regenerator_default","a","wrap","_context","prev","next","abrupt","request","method","body","stop","AgreeItem","checkbox_default","Register","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","onClickSubmit","e","preventDefault","_this$state","state","name","username","email","password","test","_x","_fetchRegister","apply","arguments","fetchRegister","then","result","id","toast_default","success","fail","message","catch","err","onChangeProtocol","value","setState","protocol","target","checked","onChangeNickName","replace","length","haseErrorNickName","onChangeUserName","haseErrorUserName","onChangeEmail","haseErrorEmail","onChangePass","haseErrorPass","onClickShowPass","isShowPass","showPassStyle","onClickHidePass","react_default","createElement","className","classnames","styles","list_default","input_item_default","clear","type","placeholder","onChange","minLength","maxLength","extra","defineProperty","concat","onExtraClick","bind","flex_default","Item","wing_blank_default","defaultChecked","data-seed","react_router_dom","to","white_space_default","button_default","disabled","onClick","PureComponent","createForm","withRouter","connect","currentUser","user"],"mappings":"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","file":"static/js/20.7d7d5f47.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"user-form-list\":\"a49ZF20SrPYhqRK3kJ9dB\",\"title\":\"_1XcbMcssPTATg9nItcMGrC\",\"link\":\"_2uwbRc-Wo3N2zPhbTw2hZC\",\"show-pass-style\":\"_2GfKBdi-7chLc8aRmLkqcj\",\"hide\":\"_1v15fmTrGAui_y-n1g4Dqm\",\"tips\":\"_3xmGw363_RfcsBWIdTw7pd\"};","import request from '@/utils/request'\n\nexport async function fetchRegister(params) {\n  return request('/v4/users', {\n    method: 'POST',\n    body: params,\n  })\n}\n","import React, { PureComponent } from 'react'\nimport { withRouter, Link } from 'react-router-dom'\nimport { createForm } from 'rc-form'\nimport PropTypes from 'prop-types'\nimport { connect } from 'react-redux'\nimport {\n  List,\n  InputItem,\n  Toast,\n  Button,\n  WhiteSpace,\n  WingBlank,\n  Flex,\n  Checkbox,\n} from 'antd-mobile'\nimport { fetchRegister } from '@/api/register'\nimport classnames from 'classnames'\nimport styles from './Styles.module.less'\n\nconst AgreeItem = Checkbox.AgreeItem\nclass Register extends PureComponent {\n  static propTypes = {\n    currentUser: PropTypes.object.isRequired,\n    dispatch: PropTypes.func.isRequired,\n  }\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      name: '',\n      username: '',\n      email: '',\n      password: '',\n      haseErrorNickName: false, // 昵称是否输满6位\n      haseErrorUserName: false, // 用户名是否输满6位\n      haseErrorPass: false, // 密码是否输满6位\n      haseErrorEmail: false,\n      protocol: true, // “注册协议”勾选状态\n    }\n  }\n\n  // 提交注册\n  onClickSubmit = e => {\n    e.preventDefault()\n    let { name, username, email, password } = this.state\n    // 验证邮箱格式\n    const regEmail = /^([A-Za-z0-9_\\-\\.])+\\@([A-Za-z0-9_\\-\\.])+\\.([A-Za-z]{2,4})$/\n    if (typeof email === 'undefined' || email === '') {\n      Toast.fail('邮箱不能为空', 3, null, false)\n      return\n    } else if (!regEmail.test(email)) {\n      Toast.fail('邮箱格式不正确', 3, null, false)\n      return\n    }\n    // 验证密码格式\n    const regLoginPassword = /([a-zA-Z0-9!@#$%^&*()_?<>{}]){8,16}/\n    if (typeof password === 'undefined' || password === '') {\n      Toast.fail('密码不能为空', 3, null, false)\n      return\n    } else if (!regLoginPassword.test(password)) {\n      Toast.fail('密码格式不正确', 3, null, false)\n      return\n    }\n    // 提交注册\n    const payload = { name, username, email, password }\n    fetchRegister(payload)\n      .then(result => {\n        if (typeof result !== 'undefined' && typeof result.id !== 'undefined') {\n          Toast.success('恭喜您注册成功', 3, null, false)\n        } else {\n          Toast.fail(typeof result !== 'undefined' ? result.message : '用户得到授权，但是访问是被禁止的')\n        }\n      })\n      .catch(err => {\n        Toast.fail(err.message)\n      })\n  }\n  // 改变注册协议状态\n  onChangeProtocol = value => {\n    this.setState({\n      protocol: value.target.checked,\n    })\n  }\n  onChangeNickName = value => {\n    if (value.replace(/\\s/g, '').length < 4) {\n      this.setState({\n        haseErrorNickName: false,\n      })\n    } else {\n      this.setState({\n        haseErrorNickName: true,\n      })\n    }\n    this.setState({\n      name: value,\n    })\n  }\n  onChangeUserName = value => {\n    if (value.replace(/\\s/g, '').length < 4) {\n      this.setState({\n        haseErrorUserName: false,\n      })\n    } else {\n      this.setState({\n        haseErrorUserName: true,\n      })\n    }\n    this.setState({\n      username: value,\n    })\n  }\n  onChangeEmail = value => {\n    if (value.replace(/\\s/g, '').length < 3) {\n      this.setState({\n        haseErrorEmail: false,\n      })\n    } else {\n      this.setState({\n        haseErrorEmail: true,\n      })\n    }\n    this.setState({\n      email: value,\n    })\n  }\n  onChangePass = value => {\n    if (value.replace(/\\s/g, '').length < 8) {\n      this.setState({\n        haseErrorPass: false,\n      })\n    } else {\n      this.setState({\n        haseErrorPass: true,\n      })\n    }\n    this.setState({\n      password: value,\n    })\n  }\n  // 显示密码\n  onClickShowPass = () => {\n    this.setState({\n      isShowPass: true,\n      showPassStyle: '隐藏',\n    })\n  }\n  // 隐藏密码\n  onClickHidePass = () => {\n    this.setState({\n      isShowPass: false,\n      showPassStyle: '显示',\n    })\n  }\n  render() {\n    return (\n      <div className={classnames(styles['user-form-list'], styles['register'])}>\n        <List>\n          <div className={styles['title']}>注册</div>\n          <InputItem\n            value={this.state.name}\n            clear\n            type='text'\n            placeholder='请输入昵称'\n            onChange={this.onChangeNickName}\n          >\n            昵称\n          </InputItem>\n          <InputItem\n            value={this.state.username}\n            clear\n            type='text'\n            placeholder='请输入用户名'\n            onChange={this.onChangeUserName}\n          >\n            用户名\n          </InputItem>\n          <InputItem\n            value={this.state.email}\n            clear\n            type='email'\n            placeholder='请输入 Email'\n            onChange={this.onChangeEmail}\n          >\n            Email\n          </InputItem>\n          <InputItem\n            value={this.state.password}\n            clear\n            type={this.state.isShowPass ? 'text' : 'password'}\n            placeholder='请输入8-16位密码'\n            minLength={8}\n            maxLength={16}\n            onChange={this.onChangePass}\n            extra={\n              <div\n                className={classnames(\n                  { [`${styles['show-pass-style']}`]: true },\n                  {\n                    [`${styles['hide']}`]: this.state.isShowPass,\n                  }\n                )}\n              >\n                {this.state.showPassStyle}\n              </div>\n            }\n            onExtraClick={\n              this.state.isShowPass\n                ? this.onClickHidePass.bind(this)\n                : this.onClickShowPass.bind(this)\n            }\n          >\n            密码\n          </InputItem>\n          <Flex>\n            <Flex.Item>\n              <WingBlank>\n                <AgreeItem\n                  defaultChecked={this.state.protocol}\n                  data-seed='logId'\n                  className={styles['agree-checkbox']}\n                  onChange={this.onChangeProtocol}\n                >\n                  我已阅读并同意\n                  <Link to='/agreement'>《用户注册协议》</Link>\n                </AgreeItem>\n              </WingBlank>\n            </Flex.Item>\n          </Flex>\n          <WhiteSpace /> <WhiteSpace /> <WhiteSpace />\n          <WingBlank>\n            <WingBlank>\n              <Button\n                type='primary'\n                disabled={\n                  !(\n                    this.state.haseErrorNickName &&\n                    this.state.haseErrorUserName &&\n                    this.state.haseErrorEmail &&\n                    this.state.haseErrorPass &&\n                    this.state.protocol\n                  )\n                }\n                onClick={this.onClickSubmit.bind(this)}\n              >\n                注册\n              </Button>\n            </WingBlank>\n          </WingBlank>\n          <WhiteSpace /> <WhiteSpace /> <WhiteSpace />\n        </List>\n      </div>\n    )\n  }\n}\n\nconst mapStateToProps = state => {\n  const {\n    user: { currentUser },\n  } = state\n\n  return {\n    currentUser,\n  }\n}\nexport default createForm()(withRouter(connect(mapStateToProps)(Register)))\n"],"sourceRoot":""}